---
title: "team_04.qmd"
format: 
  html:
    toc: true
    toc-depth: 2
    embed-resources: true
    warning: false
author: "Ashsyahid, Owen, Sherwyn, Xuan Yu, Nigel"
number_sections: false
knitr:
  opts_chunk:
    message: false
---

```{r}
#| label: load-packages
#| warning: false
#| echo: false

library(ncdf4)
library(reshape2)
library(plotly)
library(dplyr)
library(sf)
library(rnaturalearth)
library(zoo)
library(naniar)
```


```{r}
#| label: load-clean-data
#| warning: false
#| echo: false

df_clean <- read.csv("data/df_filtered.csv")
```

# Data Visualization

```{r}
#| warning: false
#| echo: false
#| label: plot-1

max <- max(df_clean$mean_anomaly)
min <- -max

# Create the plot with animation
plot <- plot_ly(df_clean,
  type = "scattergeo", mode = "markers",
  lon = ~lon, lat = ~lat,
  frame = ~year,  # Add this line for animation
  marker = list(
    size = 10,
    symbol = "square",
    opacity = 0.4,
    color = ~mean_anomaly,
    colorscale = "RdBu",
    cmax = max,
    cmin = min,
    colorbar = list(title = "Temperature Anomaly (C)")
  ),
  text = ~paste(
    "Longitude: ", lon, "<br>Latitude: ", lat,
    "<br>Temperature Anomaly: ", mean_anomaly
  )
) %>%
  layout(
    title = "Temperature Anomaly Over Time",
    geo = list(
      projection = list(type = "natural earth"),
      showcountries = TRUE,
      countrycolor = "black",
      showframe = FALSE
    )
  )

# Show the plot
plot
```


